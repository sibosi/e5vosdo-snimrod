name: PR label policy

on:
  pull_request:
    types:
      [
        opened,
        reopened,
        synchronize,
        labeled,
        unlabeled,
        edited,
        ready_for_review,
      ]

permissions:
  pull-requests: read

concurrency:
  group: pr-label-policy-${{ github.pull_request.number }}
  cancel-in-progress: true

jobs:
  label-policy:
    name: label-policy
    runs-on: ubuntu-latest

    steps:
      - name: Fail if PR has invalid label
        uses: actions/github-script@v7
        with:
          script: |
            const forbidden = new Set(["invalid"]);
            const labels = (context.payload.pull_request.labels || []).map(l => l.name);
            const hit = labels.filter(l => forbidden.has(l));
            core.info(`Labels on PR: ${labels.join(", ") || "(none)"}`);
            if (hit.length) {
              core.setFailed(`Merge blocked: forbidden label present: ${hit.join(", ")}`);
            }
